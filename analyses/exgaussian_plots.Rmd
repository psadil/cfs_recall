---
title: "RT Distibution Plots "
author: "pss"
date: "November 3, 2017"
output: html_document
params:
  data_dir: data
  expt: rt_distributions
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, fig.path = paste0(file.path('output','figures', params$expt),.Platform$file.sep), cache = FALSE, message = FALSE, fig.width = 7, fig.asp = 1)

library(tidyverse)
library(magrittr)
library(Hmisc)
library(ggridges)
library(modelr)
library(broom)
library(lme4)
library(lsmeans)
library(brms)
library(ggridges)

source(file.path('utils.R'))


cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

Condition = factor(c('Not Studied','CFS, Image', 'Binocular, Image'), levels = c('Not Studied','CFS, Image', 'Binocular, Image'))

colmap <- c('Not Studied'=cbPalette[7]
            ,'CFS, Image'=cbPalette[3]
            ,'Binocular, Image'=cbPalette[4])

# old_theme <- theme_set(theme_classic(base_size = 12)) +
#   theme_update(
#     axis.ticks = element_blank()
#     , axis.line = element_line(size=1)
#     , plot.margin=margin(rep(0,4))
#   )

```


# Exgaussian

This is a plot of the exponentially modified gaussian. This is the distribution that I had used last week, but it does seem to have the slightly strange property of placing positive density on RTs that are below 0. That is, the exgaussian has support over all real numbers. Lacking a lower bound, this distribution doesn't have quite as clear of a 'leading edge.' Although the parameter governing the mean of the normal component does simply shift the distribution, and that shift can make faster RTs much more likely.


```{r, exgaussian}

tibble::tibble(rt = seq(from = -1, to = 5, length.out = 1000)) %>%
  tidyr::crossing(mean = c(0, 1, 2, 3), rate = c(.5, 1, 2), standard_deviation = c(.5, 1, 2)) %>%
  dplyr::mutate(density = brms::dexgaussian(x = rt, mean, standard_deviation, rate)) %>%
  ggplot2::ggplot(aes(x = rt, y = density, color = factor(mean))) +
  facet_grid(rate~standard_deviation, labeller = "label_both") + 
  geom_line() 

```

# Weibull

In contrast, the 3-parameter Weibull distribution does have a hard leading edge (there is a 2-parameter Weibull, but the thrid parameter governs the location of a lower bound, below which the distribution has no density). The other two parameters are shape and scale parameters, whose affects can be seen below.


```{r, weibull}

tibble::tibble(rt = seq(from = -1.5, to = 5, length.out = 1000)) %>%
  tidyr::crossing(shape = c(.75,1,2), scale = seq(from = 1, to = 3, by = 1), location = -1:3) %>%
  dplyr::mutate(density = FAdist::dweibull3(x = rt, shape = shape, scale = scale, thres = location)) %>%
  ggplot2::ggplot(aes(x = rt, y = density, color = factor(location))) +
  facet_grid(shape~scale, labeller = "label_both") + 
  geom_line() 


```

# Summary

I've seen a couple of papers mention that the exgaussian is generally a good distribution for modelling RTs, both in terms of it's ability to capture the shape of the RTs as well as it's relative ease to fit. However, the exgaussian does not have a lower bound, and both the rate of the exponential component and the mean of the gaussian component can alter the amount of density placed on the fastest RT. In contrast, the Weibull distribution has a parameter that is directly responsible for the leading edge.

That said, how necessary is it that studying an item strictly increases the leading edge, rather than simply shifts the distribution? That is, it seems possible that, for entirely uninteresting reasons, the fastest RT for an item that was Not Studied just happens to be faster than the fastest Binocularly studied item (e.g., the participant happened to anticipate when the item was going to start appearing). Instead, the larger goal is to demonstrate that studying an object (even without much awareness), shortens, on average, that initial time to encode and respond? Emphasizing the average time to encode and respond is slightly different than the leading edge because a shorter time to encode and respond says that the whole distribution needs to move -- rather than just the fastest RT. 

All that is to say is that it seems like a lack of a hard lower bound isn't necessarily a reason to avoid the exgaussian. I suppose it stil feels a little odd to use a distribution which places density on RTs below 0, but that could partly be alleviated by at least truncating the exgaussian distribution.



```{r, wiener}

# Diffusion Process 

# There's also the Wiener Process / distribution. I suppose that this has the added advantage in being easily describable in cognitive terms. In particular, there is a shift parameter that maps on to our desired interpretation. 


# tibble::tibble(rt = seq(from = 0, to = 4, length.out = 100)) %>%
#   tidyr::crossing(alpha = seq(from=1,to=2,by=.5), tau = seq(from=.5,to=2,by=.5), delta = seq(from=-1, to=.5, by=.5)) %>%
#   mutate(beta = .5) %>%
#   dplyr::mutate(density = purrr::pmap_dbl(list(x=rt,alpha=alpha,tau=tau,beta=beta,delta=delta), brms::dwiener )) %>%
#   ggplot2::ggplot(aes(x = rt, y = density, color = factor(tau))) +
#   facet_grid(alpha~delta, labeller = "label_both") +
#   geom_line()


```
